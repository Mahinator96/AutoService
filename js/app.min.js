/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";var e,t,a,r,o={240:(e,t,a)=>{a.a(e,(async(e,t)=>{try{var r=a(232),o=e([r]);r=(o.then?(await o)():o)[0],t()}catch(e){t(e)}}))},232:(e,t,a)=>{a.a(e,(async(e,t)=>{try{const e=document.querySelector(".connection__form"),a=e.querySelector(".form__buttons-item--prev"),r=e.querySelector(".form__buttons-item--next"),o=e.querySelector(".form__buttons-item--submit"),n=e.querySelector(".form__group-time"),i=e.querySelector(".form__fieldset-way"),s=e.querySelector(".form__fieldset-date"),l=e.querySelector(".form__fieldset-feedback"),c=[i,s,l],d=e.querySelector(".form__info"),m=d.querySelector(".form__info-work"),y=d.querySelector(".form-reservation__moment"),f=i.querySelector(".form__radios.form__radios-direction"),p=s.querySelector(".form__radios.form__day"),u=s.querySelector(".form__group-btns.form__month"),_=s.querySelector(".form__group.form__group-time .form__radios");let h=new Intl.DateTimeFormat("ru-RU",{month:"long"}).format(new Date),v=0;const b=async()=>{try{const e=await fetch("https://climbing-small-throat.glitch.me/api");if(!e.ok)throw new Error(`HTTP error! Status ${e.status}`);return await e.json()}catch(e){console.log(`Ошибка при получении данных: ${e}`)}},S=await b(),w={dataType:{},day:"",time:""},g=(e,t,a)=>{e.textContent="",a.forEach((a=>{const r=document.createElement("div");r.className="form__radios-item radio";const o=document.createElement("input");o.className="radio__input",o.type="radio",o.id=a.value,o.value=a.value,o.name=t;const n=document.createElement("label");n.className="button radio__label button--gray",n.htmlFor=a.value,n.textContent=a.title,r.append(o,n),e.append(r)}))},x=["январь","февраль","март","апрель","май","июнь","июль","август","сенябрь","октябрь","ноябрь","октябрь","декабрь"],E=()=>{const e=`${(new Date).getFullYear()}-${(x.findIndex((e=>e===h))+1).toString().padStart(2,"0")}-${w.day.toString().padStart(2,"0")}T${w.time}`,t=new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});m.textContent=w.dataType.title,y.innerHTML=`\n    <span class="form-reservation__moment-day">${t}</span>\n    <span class="form-reservation__moment-time">${w.time}</span>\n  `,y.dateTime=e},q=e=>{for(let t=0;t<e.length;t++)t==v?c[t].classList.add("form__fieldset--active"):c[t].classList.remove("form__fieldset--active");0===v?(r.style.display="flex",o.style.display="none",a.disabled=!0):v===c.length-1?(a.style.display="flex",r.style.display="none",o.style.display="flex",E()):(a.style.display="flex",r.style.display="flex",o.style.display="none",a.disabled=!1)};q(c);const L=e=>{const t=e.find((e=>e.month===h)),a=Object.keys(t.day).map((e=>({value:e,title:e})));g(p,"day",a)},T=e=>{u.textContent="";const t=e.map((e=>{const t=document.createElement("button");return t.className="form__month-btn",t.type="button",t.textContent=e,e===h&&t.classList.add("form__month-btn--active"),t}));u.append(...t),t.forEach((e=>{e.addEventListener("click",(({target:e})=>{if(e.classList.contains("form__month-btn--active"))return;t.forEach((e=>{e.classList.remove("form__month-btn--active")})),e.classList.add("form__month-btn--active"),h=e.textContent.toLowerCase();const a=S.find((e=>e.type===w.dataType.type)).date;L(a)}))}))},k=(e,t)=>{const a=e.find((e=>e.month===h)).day[t].map((e=>({value:`${e}:00`,title:`${e}:00`})));g(_,"time",a),n.style.display="flex"},$=({target:e})=>{if(e.value&&0===v){r.disabled=!1;const t=S.find((t=>t.type===e.value));w.dataType.type=t.type,w.dataType.title=t.title;const a=t.date,o=a.map((e=>e.month));T(o),L(a)}if(1===v){if(e.value&&"day"===e.name){w.day=e.value;const t=S.find((e=>e.type===w.dataType.type)).date;k(t,w.day)}e.value&&"time"===e.name?(w.time=e.value,r.disabled=!1):r.disabled=!0}if(2===v){const e=l.querySelectorAll("input");let t=!0;e.forEach((e=>{""===e.value.trim()&&(t=!1)})),o.disabled=!t}},C=()=>{const e=S.map((e=>({value:e.type,title:e.title})));g(f,"radioWay",e)};r.addEventListener("click",(()=>{v<c.length-1&&(v+=1,q(c),r.disabled=!0,o.disabled=!0)})),a.addEventListener("click",(()=>{v>0&&(v-=1,q(c),r.disabled=!1)})),e.addEventListener("input",$),C(),e.addEventListener("submit",(async t=>{t.preventDefault();const a=new FormData(e),r=Object.fromEntries(a);r.month=h;try{const t=await fetch("https://climbing-small-throat.glitch.me/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok)throw new Error(`Ошибка при отправке данных: ${t.status}`);alert("Данные успешно отправлены"),e.innerHTML="<h2>Данные успешно отправлены</h2>"}catch(e){console.error(`Ошибка при отправке запроса: ${e}`)}})),t()}catch(e){t(e)}}),1)}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return o[e](a,a.exports,i),a.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i.a=(o,n,i)=>{var s;i&&((s=[]).d=-1);var l,c,d,m=new Set,y=o.exports,f=new Promise(((e,t)=>{d=t,c=e}));f[t]=y,f[e]=e=>(s&&e(s),m.forEach(e),f.catch((e=>{}))),o.exports=f,n((o=>{var n;l=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var n=[];n.d=0,o.then((e=>{i[t]=e,r(n)}),(e=>{i[a]=e,r(n)}));var i={};return i[e]=e=>e(n),i}}var s={};return s[e]=e=>{},s[t]=o,s})))(o);var i=()=>l.map((e=>{if(e[a])throw e[a];return e[t]})),c=new Promise((t=>{(n=()=>t(i)).r=0;var a=e=>e!==s&&!m.has(e)&&(m.add(e),e&&!e.d&&(n.r++,e.push(n)));l.map((t=>t[e](a)))}));return n.r?c:i()}),(e=>(e?d(f[a]=e):c(y),r(s)))),s&&s.d<0&&(s.d=0)},i(240),i(232)})();